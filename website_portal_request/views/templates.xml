<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="portal_my_home_menu_request"
              name="Portal request : Request"
              inherit_id="website_portal_v10.portal_layout"
              priority="20">
        <xpath expr="//ul[contains(@class,'o_portal_submenu')]"
               position="inside">
            <li>
                <a href="/my/requests">Requests</a>
            </li>
        </xpath>
    </template>

    <template id="portal_my_requests" name="My requests">
        <t t-call="website_portal_v10.portal_layout">
            <h3 class="page-header">Your request</h3>
            <t t-if="not reqs">
                <p>There are currently no requests in the your account.</p>
            </t>
            <t t-if="reqs">
                <table class="table table-hover table-condensed">
                    <thead>
                        <tr class="active">
                            <th>Request #</th>
                            <th>Category</th>
                            <th>Type Name</th>
                            <th>Stage</th>
                        </tr>
                    </thead>
                    <t t-foreach="reqs" t-as="req">
                        <tr>
                            <td>
                                <a t-attf-href="/my/requests/{{req.id}}"><t t-esc="req.name"/></a>
                            </td>
                            <td><span t-field="req.type_id.category_id.display_name"/></td>
                            <td><span t-field="req.type_id.name"/></td>
                            <td><span t-field="req.stage_id.name"/></td>
                        </tr>
                    </t>
                </table>
            </t>
        </t>
    </template>

    <template id="portal_my_request" name="My request">
        <t t-call="website_portal_v10.portal_layout">
            <div class="row">
                <div class="col-xs-10">
                    <h1><span t-field="req.name"/></h1>
                </div>
                <div class="col-xs-2">
                    <h2><span class="label label-primary" t-field="req.stage_id.name"/></h2>
                </div>
                <div class="col-xs-12">
                    <h3><span t-field="req.type_id.category_id.display_name"/> / 
                        <span t-field="req.type_id.name"/></h3>
                </div>
                <div class="col-xs-12">
                    <span t-field="req.request_text"/>
                </div>
            </div>
            <t t-call="website_mail.message_thread">
                <t t-set="object" t-value="req"/>
                <t t-set="chatter_mode" t-value="'json'"/>
            </t>
        </t>
    </template>

    <template id="portal_my_home_request" name="Portal My Home Request"
              inherit_id="website_portal_v10.portal_my_home" priority="25">
        <xpath expr="//div[contains(@class,'o_my_home_content')]" position="inside">
            <h3 class="page-header">
                <a href="/my/requests">Your Requests
                    <small class="ml8">
                        <t t-if="req_count">
                            <span class='badge'><t t-esc="req_count"/></span>
                        </t>
                        <t t-if="not req_count">
                            There are currently no requests for your account.
                            TODO: Create one
                        </t>
                    </small>
                </a>
            </h3>
        </xpath>
    </template>
</odoo>
